<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><title>Understanding SELinux Basics</title><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes"/><link rel="stylesheet" type="text/css" href="static/css/style.css"/>
<link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"/><link rel="schema.DCTERMS" href="http://purl.org/dc/terms/"/>
<meta name="title" content="Understanding SELinux Basics"/>
<meta name="description" content="This article provides an overview of basic SELinux components."/>
<meta name="book-title" content="Understanding SELinux Basics"/>
<meta name="tracker-url" content="https://bugzilla.suse.com/enter_bug.cgi"/>
<meta name="tracker-type" content="bsc"/>
<meta name="tracker-bsc-assignee" content="jsindelarova@suse.com"/>
<meta name="tracker-bsc-component" content="Documentation"/>
<meta name="tracker-bsc-product" content="SUSE Linux Enterprise Micro 6.0"/>
<meta name="publisher" content="SUSE"/><meta name="DC.creator" content="jsindelarova@suse.com"/><meta property="og:title" content="SELinux policy, context, and troubleshooting"/>
<meta property="og:description" content="An overview of basic SELinux components."/>
<meta property="og:type" content="article"/>
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="SELinux policy, context, and troubleshooting"/>
<meta name="twitter:description" content="An overview of basic SELinux components."/>
<script type="application/ld+json">{
    "@context": "http://schema.org",
    "@type": ["TechArticle"],
    "image": "https://www.suse.com/assets/img/suse-white-logo-green.svg",
    
     "isPartOf": {
      "@type": "CreativeWorkSeries",
      "name": "Products &amp; Solutions"
    },
    
    "inLanguage": "en",
    

    "headline": "SELinux policy, context, and troubleshooting",
  
    "description": "This article provides an overview of basic SELinux components.",
      
    "author": [
      {
        "@type": "Corporation",
        "name": "SUSE Product &amp; Solution Documentation Team",
        "url": "https://www.suse.com/assets/img/suse-white-logo-green.svg"
      }
    ],
      
    "dateModified": "2023-10-10T00:00+02:00",
      
    "datePublished": "2023-10-10T00:00+02:00",
      

    "about": [
      {
        "@type": "Thing",
        "name": "Security"
      },
      {
        "@type": "Thing",
        "name": "Configuration"
      }
    ],
  
    "mentions": [
      
      { "@type": "SoftwareApplication",
        "name": "SUSE Linux Enterprise Micro",
        "softwareVersion": "6.0",
        "applicationCategory": "Operating System",
        "operatingSystem": "Linux",
        "processorRequirements": "AMD64/Intel 64, POWER"
        
      }
      
    ],
    
    "sameAs": [
          "https://www.facebook.com/SUSEWorldwide/about",
          "https://www.youtube.com/channel/UCHTfqIzPKz4f_dri36lAQGA",
          "https://twitter.com/SUSE",
          "https://www.linkedin.com/company/suse"
    ],
    "publisher": {
      "@type": "Corporation",
      "name": "SUSE",
      "url": "https://documentation.suse.com",
      "logo": {
        "@type": "ImageObject",
        "url": "https://www.suse.com/assets/img/suse-white-logo-green.svg"
      }
    }
  }</script>
<link rel="next" href="doc-gfdl-license.html" title="A. GNU Free Documentation License"/><script type="text/javascript">

if ( window.location.protocol.toLowerCase() != 'file:' ) {
  document.write('<link rel="stylesheet" type="text/css" href="https://documentation.suse.com/docserv/res/fonts/poppins/poppins.css"></link>');
};

</script><noscript><link rel="stylesheet" type="text/css" href="https://documentation.suse.com/docserv/res/fonts/poppins/poppins.css"/></noscript><script src="static/js/script-purejs.js" type="text/javascript"> </script><script src="static/js/highlight.min.js" type="text/javascript"> </script><script>

$(document).ready(function() {
  $('.verbatim-wrap.highlight').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});
hljs.configure({
  useBR: false
});

</script></head><body class="draft wide offline js-off" onload="$('#betawarn-button-wrap').toggle();if (document.cookie.length > 0) {if (document.cookie.indexOf('betawarn=closed') != -1){$('#betawarn').toggle()}};"><div id="betawarn" style="position:fixed;bottom:0;z-index:9025;background-color:#FDE8E8;padding:1em;margin-left:10%;margin-right:10%;display:block;border-top:.75em solid #E11;width:80%"><p style="color:#333;margin:1em 0;padding:0;">This is a draft document that was built and uploaded automatically. It may document beta software and be incomplete or even incorrect. <strong>Use this document at your own risk.</strong></p> <div id="betawarn-button-wrap" style="display:none;margin:0;padding:0;"><a href="#" onclick="$('#betawarn').toggle();var d=new Date();d.setTime(d.getTime()+(0.5*24*60*60*1000));document.cookie='betawarn=closed; expires='+d.toUTCString()+'; path=/'; return false;" style="color:#333;text-decoration:underline;float:left;margin-top:.5em;padding:1em;display:block;background-color:#FABEBE;">I understand this is a draft</a></div></div><div class="bypass-block"><a href="#_content">Jump to content</a><a href="#_bottom-pagination">Jump to page navigation: previous page [access key p]/next page [access key n]</a></div><header id="_mainnav"><div class="growth-inhibitor"><img src="static/images/logo.svg" alt="Logo" class="logo"/></div></header><div class="crumbs"><div class="growth-inhibitor"><a class="crumb" href="index.html">Understanding SELinux Basics</a></div></div><main id="_content"><nav id="_side-toc-overall" class="side-toc"><div class="side-title">Understanding SELinux Basics</div> </nav><button id="_open-side-toc-overall" title="Contents"> </button><article class="documentation"><button id="_unfold-side-toc-page">On this page</button><section xml:lang="en" class="article" id="selinux-article" data-id-title="Understanding SELinux Basics"><div class="titlepage"><div><div><h1 class="title">Understanding SELinux Basics</h1></div><div class="date"><span class="imprint-label">Publication Date: </span>14 Oct 2024</div><div><div class="abstract"><div class="variablelist"><dl class="variablelist"><dt id="id-1.1.12.1.1"><span class="term">WHAT?</span></dt><dd><p>
              This article provides basic information about Security-Enhanced Linux.
            </p></dd><dt id="id-1.1.12.1.2"><span class="term">WHY?</span></dt><dd><p>
              You want to understand SELinux and how to configure it on <span class="phrase"><span class="phrase">SUSE Linux Enterprise Micro</span></span>.
            </p></dd><dt id="id-1.1.12.1.3"><span class="term">EFFORT</span></dt><dd><p>
                It takes approximately 40 minutes to read this article.
              </p></dd></dl></div></div></div><div><div class="titlepage-revhistory"><a aria-label="Revision History" hreflang="en" href="rh-selinux-article.html" target="_blank">Revision History: Understanding SELinux Basics</a></div></div></div></div><section xml:lang="en" class="sect1" id="selinux-about" data-id-title="About SELinux"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">1 </span><span class="title-name">About SELinux</span></span> <a title="Permalink" class="permalink" href="index.html#selinux-about">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a></div></div></div><div><div class="abstract"/></div></div></div><p>
    SELinux was developed as an additional Linux security solution that uses
    the security framework in the Linux kernel. The purpose was to allow for a
    more granular security policy that goes beyond the standard Discretionary
    Access Controls (DAC), the traditional file permissions of
    owner/group/world, and read/write/execute.
  </p><p>
    SELinux uses labels attached to objects (for example, files and network
    sockets) to make access control decisions.
  </p><p>
    The default action of SELinux is to deny any access. SELinux allows only
    actions that were specifically allowed in the SELinux policy. Another
    feature of SELinux that increases security is that SELinux allows strict
    confinement of processes up to the point where the processes cannot access
    files of other processes on the same system.
  </p><p>
    SELinux was designed to enhance existing security solutions, not to replace
    them. For example, discretionary access control (DAC) is still applied,
    even if the system is using SELinux. If DAC denies access first, SELinux is
    then not used as the access was already blocked by another mechanism.
  </p></section><section xml:lang="en" class="sect1" id="getting-selinux" data-id-title="Getting SELinux"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">2 </span><span class="title-name">Getting SELinux</span></span> <a title="Permalink" class="permalink" href="index.html#getting-selinux">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a></div></div></div><div><div class="abstract"/></div></div></div><p>
    SELinux is installed by default when installing <span class="phrase"><span class="phrase">SLE Micro</span></span> by
    YaST or is part of the pre-built images.
  </p><p>
    If SELinux is not set up on your system, run the following command:
  </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code>transactional-update setup-selinux</pre></div><p>
    Reboot your system after the command has finished. The command installs the
    SELinux policy if it is not installed, sets the
    <code class="literal">enforcing</code> SELinux mode and rebuilds
    <code class="literal">initrd</code>.
  </p></section><section xml:lang="en" class="sect1" id="selinux-modes" data-id-title="SELinux modes"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">3 </span><span class="title-name">SELinux modes</span></span> <a title="Permalink" class="permalink" href="index.html#selinux-modes">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a></div></div></div><div><div class="abstract"/></div></div></div><p>
    SELinux can run in one of three modes: <code class="literal">disabled</code>,
    <code class="literal">permissive</code> or <code class="literal">enforcing</code>.
  </p><p>
    Using the <code class="literal">disabled</code> mode means that no rules from the
    SELinux policy are applied and your system is not protected. Therefore, we
    do not recommend using the <code class="literal">disabled</code> mode.
  </p><p>
    In the <code class="literal">permissive</code> mode, SELinux is active, the security
    policy is loaded, the file system is labeled and access denial entries are
    logged. However, the policy is not enforced and thus no access is actually
    denied.
  </p><p>
    In the <code class="literal">enforced</code> mode, the security policy is applied.
    Each access that is not explicitly allowed by the policy is denied.
    
  </p><p>
    For information about switching between SELinux modes, refer to
    <a class="xref" href="index.html#selinux-switching-modes" title="3.1. Changing the SELinux mode">Section 3.1, “Changing the SELinux mode”</a>.
  </p><section xml:lang="en" class="sect2" id="selinux-switching-modes" data-id-title="Changing the SELinux mode"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">3.1 </span><span class="title-name">Changing the SELinux mode</span></span> <a title="Permalink" class="permalink" href="index.html#selinux-switching-modes">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a></div></div></div><div><div class="abstract"/></div></div></div><p>
    You can switch the SELinux mode temporarily or permanently.
  </p><section class="sect3" id="sellinux-temporary-mode-changes" data-id-title="Changing the SELinux mode temporarily"><div class="titlepage"><div><div><div class="title-container"><h4 class="title"><span class="title-number-name"><span class="title-number">3.1.1 </span><span class="title-name">Changing the SELinux mode temporarily</span></span> <a title="Permalink" class="permalink" href="index.html#sellinux-temporary-mode-changes">#</a></h4><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a></div></div></div></div></div><p>
      To set SELinux to the <code class="literal">permissive</code> or
      <code class="literal">enforcing</code> mode temporarily, use the command
      <code class="command">setenforce</code>.
    </p><p>
      The <code class="command">setenforce</code> command has the following syntax:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code>setenforce <em class="replaceable">MODE_ID</em></pre></div><p>
      where <em class="replaceable">MODE_ID</em> is <em class="replaceable">0</em>
      for the <code class="literal">permissive</code> mode or
      <em class="replaceable">1</em> for the <code class="literal">enforced</code> mode.
    </p><p>
      Remember that you cannot disable SELinux using the
      <code class="command">setenforce</code> command.
    </p></section><section class="sect3" id="selinux-permanent-mode-changes" data-id-title="Changing the SELinux mode permanently"><div class="titlepage"><div><div><div class="title-container"><h4 class="title"><span class="title-number-name"><span class="title-number">3.1.2 </span><span class="title-name">Changing the SELinux mode permanently</span></span> <a title="Permalink" class="permalink" href="index.html#selinux-permanent-mode-changes">#</a></h4><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a></div></div></div></div></div><p>
      To perform changes to the SELinux mode that persists rebooting of the
      system, edit the <code class="filename">/etc/selinux/config</code> configuration
      file. In this file, you can also disable SELinux on your system. However,
      this action is not recommended. If SELinux is possibly causing issues to
      your system, switch to the <code class="literal">permissive</code> mode instead and
      debug your system.
    </p><p>
      In the file <code class="filename">/etc/selinux/config</code>, change the value of
      <code class="literal">SELINUX</code> to <code class="literal">disabled</code>, or
      <code class="literal">permissive</code>, or <code class="literal">enforced</code> as follows:
    </p><div class="verbatim-wrap"><pre class="screen">SELINUX=disabled</pre></div><p>
      The changes in the file are applied after the next reboot.
    </p><div id="id-1.4.7.4.6" data-id-title="Relabeling your system after switching from the disabled mode" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.svg"/><div class="admon-title">Note: Relabeling your system after switching from the <code class="literal">disabled</code> mode</div><p>
        If you disable SELinux on your system and then enable it later, make
        sure that you relabel your system. When SELinux is disabled and you
        perform changes to your file system, the changes are not reflected in
        the context anymore (for example, new files do not have any context).
        Therefore, you need to relabel your system by using the
        <code class="command">restorecon</code> command, using the
        <code class="literal">autorelabel</code> boot parameter, or by creating a file
        that will trigger relabeling on the next boot. To create the file, run
        the following command:
      </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code>touch /etc/selinux/.autorelabel</pre></div><p>
        After reboot, the file <code class="filename">/etc/selinux/.autorelabel</code>
        is replaced with another flag file,
        <code class="filename">/etc/selinux/.relabelled</code>, to prevent relabeling on
        subsequent reboots.
      </p></div></section><section class="sect3" id="selinux-verify-mode" data-id-title="Verifying the active SELinux mode"><div class="titlepage"><div><div><div class="title-container"><h4 class="title"><span class="title-number-name"><span class="title-number">3.1.3 </span><span class="title-name">Verifying the active SELinux mode</span></span> <a title="Permalink" class="permalink" href="index.html#selinux-verify-mode">#</a></h4><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a></div></div></div></div></div><p>
      To verify the mode, run the following command:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code>getenforce</pre></div><p>
      The command should return <code class="literal">permissive</code> or
      <code class="literal">enforced</code>, depending on the provided
      <em class="replaceable">MODE_ID</em>.
    </p></section></section><section xml:lang="en" class="sect2" id="task-verification" data-id-title="Verifying that SELinux is functional"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">3.2 </span><span class="title-name">Verifying that SELinux is functional</span></span> <a title="Permalink" class="permalink" href="index.html#task-verification">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a></div></div></div><div><div class="abstract"/></div></div></div><p>
    If you are performing configuration changes, it may be useful to switch to
     permissive mode. During this time, users might label files incorrectly,
    and thus cause problems when switching back to enforcing mode.
  </p><p>
    To return the system back to its secured state, perform the following steps:
  </p><div class="procedure"><div class="procedure-contents"><ol class="procedure" type="1"><li class="step"><p>
        Reset the security context:
      </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">&gt; </code><code class="command">sudo</code> <code class="command">restorecon -R /</code></pre></div></li><li class="step"><p>
        Switch to enforcing mode by setting
        <code class="option">SELINUX=enforcing</code> in the
        <code class="filename">/etc/selinux/config</code>.
      </p></li><li class="step"><p>
        Reboot the system and log in again.
      </p></li><li class="step"><p>
        Run the <code class="command">sestatus -v</code> command. It should give you an
        output similar to the following one:
      </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">&gt; </code><code class="command">sudo</code> <code class="command">sestatus -v</code>
SELinux status:                 enabled
SELinuxfs mount:                /sys/fs/selinux
SELinux root directory:         /etc/selinux
Loaded policy name:             targeted
Current mode:                   enforcing
Mode from config file:          enforcing
Policy MLS status:              enabled
Policy deny_unknown status:     allowed
Memory protection checking:     requested(insecure)
Max kernel policy version:      33

Process contexts:
Current context:                unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023
Init context:                   system_u:system_r:init_t:s0
/usr/sbin/sshd                  system_u:system_r:sshd_t:s0-s0:c0.c1023

File contexts:
Controlling terminal:           unconfined_u:object_r:user_tty_device_t:s0
/etc/passwd                     system_u:object_r:passwd_file_t:s0
/etc/shadow                     system_u:object_r:shadow_t:s0
/bin/bash                       system_u:object_r:shell_exec_t:s0 \
                                -&gt; system_u:object_r:shell_exec_t:s0
/bin/login                      system_u:object_r:login_exec_t:s0
/bin/sh                         system_u:object_r:bin_t:s0 \
                                -&gt; system_u:object_r:shell_exec_t:s0
/sbin/agetty                    system_u:object_r:bin_t:s0 \
                                -&gt; system_u:object_r:getty_exec_t:s0
/sbin/init                      system_u:object_r:bin_t:s0 -&gt; \
                                system_u:object_r:init_exec_t:s0
/usr/sbin/sshd                  system_u:object_r:sshd_exec_t:s0</pre></div></li><li class="step"><p>
        If the system is not working properly, check the log files in
        <code class="filename">/var/log/audit/audit.log</code>. For more details, 
        refer to <a class="link" href="https://documentation.suse.com/sle-micro/6.0/html/Micro-setroubleshoot/setroubleshoot.html" target="_blank">SELinux troubleshooting</a>.
      </p></li></ol></div></div></section></section><section xml:lang="en" class="sect1" id="selinux-context" data-id-title="SELinux security context"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">4 </span><span class="title-name">SELinux security context</span></span> <a title="Permalink" class="permalink" href="index.html#selinux-context">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a></div></div></div><div><div class="abstract"/></div></div></div><p>
    The security context is a set of information assigned to a file or a
    process. It consists of SELinux user, role, type, level and category. This
    information is used to make access control decisions.
  </p><div class="variablelist"><div class="title-container"><div class="variablelist-title-wrap"><div class="variablelist-title"><span class="title-number-name"><span class="title-name">SELinux context fields </span></span><a title="Permalink" class="permalink" href="index.html#id-1.5.3">#</a></div></div><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a></div></div><dl class="variablelist"><dt id="id-1.5.3.2"><span class="term">SELinux user</span></dt><dd><p>
          An identity defined in the policy that is authorized for a specific
          set of roles and for a specific <span class="emphasis"><em>level</em></span> range.
          Each Linux user is mapped to only one SELinux user. However, one
          SELinux user can have several roles.
        </p><p>
          SELinux does not use the list of user accounts maintained by Linux in
          <code class="filename">/etc/passwd</code>, but uses its own database and
          mapping. By convention, the identity name is suffixed with
          <code class="literal">_u</code>, for example, <code class="literal">user_u</code>.
        </p><p>
          When a new Linux account is created and the SELinux user is not
          assigned to the account, the default SELinux user is used. Usually,
          the default value is <code class="literal">unconfined_u</code>. For a procedure
          on how to change the default value, refer to
          <a class="xref" href="index.html#semanage-login-command" title="7.5.2. The semanage login command">Section 7.5.2, “The <code class="command">semanage login</code> command”</a>.
        </p></dd><dt id="id-1.5.3.3"><span class="term">role</span></dt><dd><p>
          Defines a set of permissions that a user can be granted. A role
          defines which <span class="emphasis"><em>types</em></span> a user assigned to this role
          can access. By convention, the role name is suffixed with
          <code class="literal">_r</code>, for example, <code class="literal">system_r</code>.
        </p></dd><dt id="id-1.5.3.4"><span class="term">type</span></dt><dd><p>
          The type conveys information on how particular files and processes
          can interact. A process consists of files with a concrete SELinux
          type, and it cannot access files outside of this type. By convention,
          the type name is suffixed with <code class="literal">_t</code>, for example,
          <code class="literal">var_t</code>.
        </p></dd><dt id="id-1.5.3.5"><span class="term">level</span></dt><dd><p>
          An optional attribute that specifies the range of levels of clearance
          in the multilevel security.
        </p></dd><dt id="id-1.5.3.6"><span class="term">category</span></dt><dd><p>
          An optional attribute that allows you to add categories to processes,
          files and users. A user can then access files that have the same
          category.
        </p></dd></dl></div><p>
    Here is an example of an SELinux context:
  </p><div class="verbatim-wrap"><pre class="screen">allow user_t bin_t:file {read execute gettattr};</pre></div><p>
    This example rule states that the user who has the context type
    <code class="systemitem">user_t</code> (this user is called the
    source object) is allowed to access objects of the class
    <span class="emphasis"><em>file</em></span> with the context type <code class="filename">bin_t</code>
    (the target), using the permissions <code class="literal">read</code>,
    <code class="literal">execute</code> and <code class="literal">getattr</code>.
  </p></section><section xml:lang="en" class="sect1" id="selinux-policy" data-id-title="SELinux policy overview"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">5 </span><span class="title-name">SELinux policy overview</span></span> <a title="Permalink" class="permalink" href="index.html#selinux-policy">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a></div></div></div><div><div class="abstract"/></div></div></div><p>
    The policy is the key component in SELinux. Your SELinux policy defines
    rules that specify which objects can access which files, directories, ports
    and processes on a system. To do this, a security context is defined for
    all of these.
  </p><p>
    An SELinux policy contains a huge number of rules. To make it more
    manageable, policies are often split into modules. This allows the
    administrator to switch protection on or off for different parts of the
    system.
  </p><p>
    When compiling the policy for your system, you will have a choice to either
    work with a modular policy, or a monolithic policy, where one huge policy
    is used to protect everything on your system. We strongly recommend using a
    modular policy and not a monolithic policy. Modular policies are much
    easier to manage.
  </p><p>
    <span class="phrase"><span class="phrase">SLE Micro</span></span> is shipped with the <code class="literal">targeted</code> SELinux
    policy.
  </p><section xml:lang="en" class="sect2" id="selinux-switching-modules" data-id-title="Working with SELinux modules"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">5.1 </span><span class="title-name">Working with SELinux modules</span></span> <a title="Permalink" class="permalink" href="index.html#selinux-switching-modules">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a></div></div></div><div><div class="abstract"/></div></div></div><p>
    As an administrator, you can switch modules on or off. This can be useful
    if you want to disable only a part of the SELinux policy and you do not
    want to run a specific service without SELinux protection.
  </p><p>
    To view all SELinux policy modules in use, run the command:
  </p><div class="verbatim-wrap"><pre class="screen"><code class="command">semodule -l</code></pre></div><p>
    After you get the name of the module you want to switch off, run the
    command:
  </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">&gt; </code><code class="command">sudo</code> <code class="command">semodule -d <em class="replaceable">MODULENAME</em></code></pre></div><p>
    To switch on the policy module, run the command:
  </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">&gt; </code><code class="command">sudo</code> <code class="command">semodule -e <em class="replaceable">MODULENAME</em></code></pre></div></section><section xml:lang="en" class="sect2" id="creating-policy-containers" data-id-title="Creating policies for containers"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">5.2 </span><span class="title-name">Creating policies for containers</span></span> <a title="Permalink" class="permalink" href="index.html#creating-policy-containers">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a></div></div></div><div><div class="abstract"/></div></div></div><p>
    <span class="phrase"><span class="phrase">SLE Micro</span></span> is delivered with a policy that, by default, does not
    allow containers to access files outside the container data. On the other
    hand, all network access is allowed. Typically, containers are created with
    bind mounts and should be able to access other directories, like
    <code class="filename">/home</code> or <code class="filename">/var</code>. You may want a
    possibility to allow access to these directories or, on the contrary,
    restrict some ports to the container even if SELinux is used on your
    system. In this case, you need to create new policy rules that enable or
    disable the access. <span class="phrase"><span class="phrase">SLE Micro</span></span> provides the Udica tool for this
    purpose.
  </p><p>
    The following procedure describes how to create a custom policy for your
    containers:
  </p><div class="procedure"><div class="procedure-contents"><ol class="procedure" type="1"><li class="step"><p>
        Make sure that SELinux is in the enforcing mode. For details, refer to
        <a class="xref" href="index.html#selinux-switching-modes" title="3.1. Changing the SELinux mode">Section 3.1, “Changing the SELinux mode”</a>.
      </p></li><li class="step"><p>
        Start a container using the following parameters:
      </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code>podman run -v /home:/home:rw -v /var/:/var/:rw -p 21:21 -it sle15 bash</pre></div><p>
        The container runs with the default policy that does not allow access
        to the mount points but does not restrict other ports.
      </p></li><li class="step"><p>
        You can exit the container.
      </p></li><li class="step"><p>
        Obtain the container ID:
      </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code>podman ps -a

CONTAINER ID  IMAGE                                                                              COMMAND     CREATED        STATUS            PORTS               NAMES
e59f9d0f86f2  registry.opensuse.org/devel/bci/tumbleweed/containerfile/opensuse/bci/ruby:latest  /bin/bash   8 minutes ago  Up 8 seconds ago  0.0.0.0:21-&gt;21/tcp  zen_ramanujan</pre></div></li><li class="step"><p>
        Create a JSON file that Udica will use to create a custom policy for
        the container:
      </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code>podman inspect e59f9d0f86f2 &gt; <em class="replaceable">OUTPUT_JSON_FILE</em></pre></div><p>
        For example, substitute <em class="replaceable">OUTPUT_JSON_FILE</em>
        with <code class="filename">container.json</code>.
      </p></li><li class="step"><p>
        Run Udica to generate a policy according to the container parameters:
      </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code>udica -j <em class="replaceable">OUTPUT_JSON_FILE</em>  <em class="replaceable">CUSTOM_CONTAINER_POLICY</em></pre></div><p>
        For example:
      </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code>udica -j container.json custom_policy</pre></div></li><li class="step"><p>
        According to the provided instructions, load the policy modules by
        running:
      </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code>semodule -i custom_policy.cil /usr/share/udica/templates/{base_container.cil,net_container.cil,home_container.cil}</pre></div></li><li class="step"><p>
        Run a container with the new policy module by using the
        <code class="option">--security-opt</code> option as follows:
      </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code>podman run --security-opt label=type:custom_policy.process -v /home:/home:rw -v /var/:/var/:rw -p 21:21 -it sle15 bash</pre></div></li></ol></div></div></section></section><section xml:lang="en" class="sect1" id="selinux-booleans" data-id-title="SELinux Booleans"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">6 </span><span class="title-name">SELinux Booleans</span></span> <a title="Permalink" class="permalink" href="index.html#selinux-booleans">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a></div></div></div><div><div class="abstract"/></div></div></div><p>
    SELinux Booleans support a flexible policy management approach.
    For example, Booleans enable you to disable a particular policy on one
    server, while keeping the same policy active on another one. In other
    words, a Boolean can be understood as a switch for a policy rule. Instead of
    changing a particular policy, you can switch it off. In the policy code,
    Booleans are called a <span class="emphasis"><em>tunable</em></span>. Because Booleans are included in the policy, they are available as soon as a policy is loaded.
  </p><p>
    The changes to the Booleans value may be persistent or temporary, lasting until
    the end of the session.
  </p><p>
    SELinux offers tools that enable you to list and view details or change the
    state of Booleans. See the following sections for details.
  </p><section xml:lang="en" class="sect2" id="selinux-working-with-booleans" data-id-title="Working with Booleans"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">6.1 </span><span class="title-name">Working with Booleans</span></span> <a title="Permalink" class="permalink" href="index.html#selinux-working-with-booleans">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a></div></div></div><div><div class="abstract"/></div></div></div><section class="sect3" id="listing-booleans" data-id-title="Listing Booleans"><div class="titlepage"><div><div><div class="title-container"><h4 class="title"><span class="title-number-name"><span class="title-number">6.1.1 </span><span class="title-name">Listing Booleans</span></span> <a title="Permalink" class="permalink" href="index.html#listing-booleans">#</a></h4><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a></div></div></div></div></div><p>
      You can use the <code class="command">getsebool</code> or
      <code class="command">semanage</code> command to list currently defined Booleans.
      To list all currently defined Booleans, along with their state, run the
      following command:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code>getsebool -a

abrt_anon_write --&gt; off
abrt_handle_event --&gt; off
abrt_upload_watch_anon_write --&gt; on
...</pre></div><p>
      To get more details about particular Booleans, you can use the
      <code class="command">semanage</code> command as follows:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code>semanage boolean -l

SELinux boolean               State   Default     Description

abrt_anon_write               (off  ,  off)       Allow abrt to anon write
abrt_handle_event             (off  ,  off)       Allow abrt to handle event
abrt_upload_watch_anon_write  (on   ,   on)       Allow abrt to upload watch anon write</pre></div><p>
      To get the status of an individual Boolean, you can use the following
      command:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code>getsebool <em class="replaceable">BOOLEAN_NAME</em></pre></div><p>
      Alternatively, you can just use the <code class="command">grep</code> command on
      the <code class="command">semanage boolean</code> output:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code>semanage boolean -l | grep <em class="replaceable">BOOLEAN_NAME</em></pre></div></section><section class="sect3" id="switching-booleans" data-id-title="Toggling Booleans"><div class="titlepage"><div><div><div class="title-container"><h4 class="title"><span class="title-number-name"><span class="title-number">6.1.2 </span><span class="title-name">Toggling Booleans</span></span> <a title="Permalink" class="permalink" href="index.html#switching-booleans">#</a></h4><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a></div></div></div></div></div><p>
      The commands <code class="command">setsebool</code> and <code class="command">semanage</code>
      can be used to toggle the value of Booleans. You can change the Boolean status
      persistently or just temporarily until the session ends. To change a
      Boolean value temporarily, run the following command:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code>setsebool <em class="replaceable">BOOLEAN_NAME</em> <em class="replaceable">BOOLEAN_VALUE</em></pre></div><p>
      where <em class="replaceable">BOOLEAN_VALUE</em> is either
      <code class="literal">on</code> or <code class="literal">off</code>.
    </p><p>
      To change a Boolean value persistently, run one of the following two
      commands:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code>setsebool -P <em class="replaceable">BOOLEAN_NAME</em> <em class="replaceable">BOOLEAN_VALUE</em></pre></div><p>
      Alternatively, using the <code class="command">semanage</code> command:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code>semanage boolean -m --<em class="replaceable">BOOLEAN_VALUE</em>  <em class="replaceable">BOOLEAN_NAME</em></pre></div><p>
      where <em class="replaceable">BOOLEAN_VALUE</em> is either
      <code class="literal">on</code> or <code class="literal">off</code>.
    </p><p>
      A single Boolean can enable or disable several policy rules. To see 
      which policy rules are enabled or disabled by specific Booleans, 
      use the <code class="command">sedispol</code> tool to analyze the policy file:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code>sedispol /etc/selinux/targeted/policy/policy.32</pre></div><p>
      As the policy rules are usually huge, we recommend setting an output file
      by selecting the <code class="option">f</code> and specifying a file name. After
      specifying the file name, press <code class="option">6</code>. Then you can inspect
      the file.
    </p></section></section></section><section xml:lang="en" class="sect1" id="selinux-tools" data-id-title="Tools for managing SELinux"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">7 </span><span class="title-name">Tools for managing SELinux</span></span> <a title="Permalink" class="permalink" href="index.html#selinux-tools">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a></div></div></div><div><div class="abstract"/></div></div></div><p>
    <span class="phrase"><span class="phrase">SLE Micro</span></span> provides you with tools to manage SELinux on your
    system. If the below described tools are not installed on your system,
    install the tools by running:
  </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code>transactional-update pkg install policycoreutils-python-utils</pre></div><p>
    After successful installation, reboot the system.
  </p><section class="sect2" id="selinux-z-option" data-id-title="Using the Z option"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">7.1 </span><span class="title-name">Using the <code class="option">Z</code> option</span></span> <a title="Permalink" class="permalink" href="index.html#selinux-z-option">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a></div></div></div></div></div><p>
      Where SELinux is installed and configured, you can use the
      <code class="option">-Z</code> to regular commands like <code class="command">ls</code>,
      <code class="command">id</code> or <code class="command">ps</code>. Using this option, you
      can display the security context of files or processes. For example, with the
      <code class="command">ls</code> command:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">&gt; </code>ls -Z /etc/shadow

        system_u:object_r:shadow_t:s0 /etc/shadow</pre></div></section><section class="sect2" id="sec-chcon-command" data-id-title="The chcon command"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">7.2 </span><span class="title-name">The <code class="command">chcon</code> command</span></span> <a title="Permalink" class="permalink" href="index.html#sec-chcon-command">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a></div></div></div></div></div><p>
      The command name <code class="command">chcon</code> stands for change context. The
      command can change the full security context of a file to the value
      provided on the CLI, or it can change parts of the context.
      Alternatively, you can provide a file that serves as a reference.
    </p><p>
      To change the full security context of a file, the command syntax looks
      as follows:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code>chcon <em class="replaceable">SECURITY_CONTEXT</em> <em class="replaceable">FILENAME</em></pre></div><p>
      where:
    </p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>
          <em class="replaceable">SECURITY_CONTEXT</em> is in the format:
          <em class="replaceable">SELinux_USER</em>:<em class="replaceable">ROLE</em>:<em class="replaceable">TYPE</em>:<em class="replaceable">LEVEL</em>:<em class="replaceable">CATEGORY</em>.
          For example, the context could be:
          <span class="emphasis"><em>system_u:object_r:httpd_config_t:s0</em></span>.
        </p></li><li class="listitem"><p>
          <em class="replaceable">FILENAME</em> is a path to the file whose
          context should be changed.
        </p></li></ul></div><p>
      To set a security context according to a provided file that serves as a
      reference, run <code class="command">chcon</code> as follows:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code>chcon --reference=<em class="replaceable">REFERENCE_FILE</em> <em class="replaceable">FILENAME</em></pre></div><p>
      where:
    </p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>
          <em class="replaceable">REFERENCE_FILE</em> is a path to a file that
          should be used as a reference.
        </p></li><li class="listitem"><p>
          <em class="replaceable">FILENAME</em> is a path to the file whose
          context should be changed.
        </p></li></ul></div><p>
      Alternatively, you can change only one part of the security context. The
      general syntax of the <code class="command">chcon</code> command is as follows:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code>chcon <em class="replaceable">CONTEXT_OPTION</em> <em class="replaceable">CONTEXT_PART</em> <em class="replaceable">FILENAME</em></pre></div><p>
      The options and arguments have the following meaning:
    </p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>
          depending on the context part,
          <em class="replaceable">CONTEXT_OPTION</em> can be any of the
          following:
        </p><div class="variablelist"><dl class="variablelist"><dt id="id-1.8.6.14.1.2.1"><span class="term"><code class="option">-u</code> resp <code class="option">--user</code></span></dt><dd><p>
                denotes that an SELinux user context will be changed on the
                provided file:
              </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code>chcon -u system_u logind.conf</pre></div></dd><dt id="id-1.8.6.14.1.2.2"><span class="term"><code class="option">-r</code> resp <code class="option">--role</code></span></dt><dd><p>
                only the role part will be changed in the context of the
                provided file:
              </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code>chcon -r object_r logind.conf</pre></div></dd><dt id="id-1.8.6.14.1.2.3"><span class="term"><code class="option">-t</code> resp <code class="option">--type</code></span></dt><dd><p>
                only the type part will be changed in the context of the
                provided file:
              </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code>chcon -t etc_t logind.conf</pre></div></dd><dt id="id-1.8.6.14.1.2.4"><span class="term"><code class="option">-l</code> resp <code class="option">--range</code></span></dt><dd><p>
                only the range part of the security context will be changed:
              </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code>chcon -l s0 logind.conf</pre></div></dd></dl></div></li><li class="listitem"><p>
          <em class="replaceable">CONTEXT_PART</em> is the particular value of
          the security context to be set.
        </p></li><li class="listitem"><p>
          <em class="replaceable">FILENAME</em> is a path to the file whose
          context will be changed.
        </p></li></ul></div><div id="id-1.8.6.15" data-id-title="Using chcon on symbolic links" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.svg"/><div class="admon-title">Note: Using <code class="command">chcon</code> on symbolic links</div><p>
        By default, when you change the security context on a symbolic link,
        the context of the link target is changed and the symbolic link context
        is <span class="bold"><strong>not</strong></span> changed. To force
        <code class="command">chcon</code> to change the context of the symbolic link and
        not the link target, use the <code class="option">--no-dereference</code> option
        as shown below:
      </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code>chcon --no-dereference -u system_u -t etc_t network.conf</pre></div></div><p>
      You can change the context of all files in a directory by using the
      recursive option:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code>chcon --recursive  system_u:object_r:httpd_config_t:s0 conf.d</pre></div></section><section class="sect2" id="sec-getenforce-setenforce" data-id-title="getenforce and setenforce commands"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">7.3 </span><span class="title-name"><code class="command">getenforce</code> and <code class="command">setenforce</code> commands</span></span> <a title="Permalink" class="permalink" href="index.html#sec-getenforce-setenforce">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a></div></div></div></div></div><p>
      The <code class="command">getenforce</code> command returns the current SELinux
      mode: <code class="literal">Enforcing</code>, <code class="literal">Permissive</code> or
      <code class="literal">Disabled</code>.
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code>getenforce

Permissive</pre></div><p>
      The <code class="command">setenforce</code> command temporarily changes the SELinux
      mode to enforcing or permissive. You cannot use this command to disable
      SELinux. Remember that the change persists only until the next reboot. To
      change the state permanently, follow the description in
      <a class="xref" href="index.html#selinux-switching-modes" title="3.1. Changing the SELinux mode">Section 3.1, “Changing the SELinux mode”</a>.
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code>setenforce <em class="replaceable">MODE_ID</em></pre></div><p>
      where <em class="replaceable">MODE_ID</em> is <em class="replaceable">0</em>
      for the <code class="literal">permissive</code> mode or
      <em class="replaceable">1</em> for the <code class="literal">enforced</code> mode.
    </p></section><section class="sect2" id="sec-fixfiles-command" data-id-title="The fixfiles script"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">7.4 </span><span class="title-name">The <code class="command">fixfiles</code> script</span></span> <a title="Permalink" class="permalink" href="index.html#sec-fixfiles-command">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a></div></div></div></div></div><p>
      The script enables you to perform the following tasks with the security
      context:
    </p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>
          check if the context is correct
        </p></li><li class="listitem"><p>
          change any incorrect file context labels
        </p></li><li class="listitem"><p>
          relabel your system if you added a new policy
        </p></li></ul></div><p>
      The script syntax is as follows:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code>fixfiles [<em class="replaceable">OPTIONS</em>] <em class="replaceable">ARGUMENT</em></pre></div><p>
      where:
    </p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>
          <em class="replaceable">OPTIONS</em> can be the following:
        </p><div class="variablelist"><dl class="variablelist"><dt id="id-1.8.8.7.1.2.1"><span class="term"><code class="option">-l</code> <em class="replaceable">LOGFILE</em></span></dt><dd><p>
                saves the output to the provided file
              </p></dd><dt id="id-1.8.8.7.1.2.2"><span class="term"><code class="option">-o</code> <em class="replaceable">OUTPUT_FILE</em></span></dt><dd><p>
                saves to the provided output file the names of all files whose
                file context differs from the default
              </p></dd><dt id="id-1.8.8.7.1.2.3"><span class="term"><code class="option">-F</code></span></dt><dd><p>
                forces a reset of context
              </p></dd></dl></div></li><li class="listitem"><p>
          <em class="replaceable">ARGUMENT</em> can be one of the following:
        </p><div class="variablelist"><dl class="variablelist"><dt id="id-1.8.8.7.2.2.1"><span class="term"><code class="command">check</code></span></dt><dd><p>
                shows previous and current file context for an incorrect label
                without performing any changes
              </p></dd><dt id="id-1.8.8.7.2.2.2"><span class="term"><code class="command">relabel</code></span></dt><dd><p>
                relabels incorrect file contexts according to the currently
                loaded policy
              </p></dd><dt id="id-1.8.8.7.2.2.3"><span class="term"><code class="command">restore</code></span></dt><dd><p>
                restores incorrect file contexts to the default values
              </p></dd><dt id="id-1.8.8.7.2.2.4"><span class="term"><code class="command">verify</code></span></dt><dd><p>
                lists all files with incorrect file context labels without
                performing any changes
              </p></dd></dl></div></li></ul></div></section><section class="sect2" id="sec-semanage-command" data-id-title="The semanage command"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">7.5 </span><span class="title-name">The <code class="command">semanage</code> command</span></span> <a title="Permalink" class="permalink" href="index.html#sec-semanage-command">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a></div></div></div></div></div><p>
      The <code class="command">semanage</code> command can be used to configure parts of
      the policy without the need to recompile the policy from sources. The
      command enables you to perform the following tasks:
    </p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>
          manage Booleans by using the <code class="option">boolean</code> argument. For
          details about Booleans, refer to
          <a class="xref" href="index.html#selinux-working-with-booleans" title="6.1. Working with Booleans">Section 6.1, “Working with Booleans”</a>.
        </p></li><li class="listitem"><p>
          adjust the context of files by using the <code class="option">fcontext</code>
          argument
        </p></li><li class="listitem"><p>
          manage user mappings using the <code class="option">login</code> argument
        </p></li><li class="listitem"><p>
          manage SELinux users using the <code class="option">user</code> argument
        </p></li><li class="listitem"><p>
          manage SELinux policy modules using the <code class="option">module</code>
          argument
        </p></li></ul></div><p>
      The general command syntax looks as follows:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code>semanage <em class="replaceable">ARGUMENT</em> <em class="replaceable">OPTIONS</em> [<em class="replaceable">OBJECT_NAME</em>]</pre></div><p>
      where:
    </p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>
          <em class="replaceable">ARGUMENT</em> is one of the following:
          <code class="command">login</code>, <code class="command">user</code>,
          <code class="command">fcontext</code>, <code class="command">boolean</code>,
          <code class="command">module</code>.
        </p></li><li class="listitem"><p>
          <em class="replaceable">OPTIONS</em> depends on the provided
          <em class="replaceable">ARGUMENT</em>. Common options are described in
          <a class="xref" href="index.html#list-common-options" title="Common options">Common options</a>.
        </p></li><li class="listitem"><p>
          <em class="replaceable">OBJECT_NAME</em>, depending on the provided
          <em class="replaceable">ARGUMENT</em>, can be a login name, module name,
          file name or SELinux user.
        </p></li></ul></div><div class="variablelist" id="list-common-options" data-id-title="Common options"><div class="title-container"><div class="variablelist-title-wrap"><div class="variablelist-title"><span class="title-number-name"><span class="title-name">Common options </span></span><a title="Permalink" class="permalink" href="index.html#list-common-options">#</a></div></div><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a></div></div><dl class="variablelist"><dt id="id-1.8.9.8.2"><span class="term"><code class="option">-a</code>, <code class="option">--add</code></span></dt><dd><p>
            adds a provided object
          </p></dd><dt id="id-1.8.9.8.3"><span class="term"><code class="option">-h</code>, <code class="option">--help</code></span></dt><dd><p>
            prints the command help
          </p></dd><dt id="id-1.8.9.8.4"><span class="term">--extract</span></dt><dd><p>
            displays commands that were used to change the system (Booleans,
            file context, and so on)
          </p></dd><dt id="id-1.8.9.8.5"><span class="term"><code class="option">-l</code>, <code class="option">--list</code></span></dt><dd><p>
            lists all objects
          </p></dd><dt id="id-1.8.9.8.6"><span class="term"><code class="option">-m</code>, <code class="option">--modify</code></span></dt><dd><p>
            modifies the provided object
          </p></dd><dt id="id-1.8.9.8.7"><span class="term"><code class="option">-n</code>, <code class="option">--noheading</code></span></dt><dd><p>
            modifies the output of the listing operation by omitting headings
          </p></dd><dt id="id-1.8.9.8.8"><span class="term"><code class="option">-s</code>, <code class="option">--seuser</code></span></dt><dd><p>
            specifies the SELinux user
          </p></dd></dl></div><p>
      Other options are specific to particular <code class="command">semanage</code>
      commands and are described in corresponding sections.
    </p><section class="sect3" id="sec-semanage-fcontext" data-id-title="The semanage fcontext command"><div class="titlepage"><div><div><div class="title-container"><h4 class="title"><span class="title-number-name"><span class="title-number">7.5.1 </span><span class="title-name">The <code class="command">semanage fcontext</code> command</span></span> <a title="Permalink" class="permalink" href="index.html#sec-semanage-fcontext">#</a></h4><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a></div></div></div></div></div><p>
        Using the <code class="command">semanage fcontext</code> command, you can perform
        the following tasks:
      </p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>
            query file context definitions
          </p></li><li class="listitem"><p>
            add contexts on files
          </p></li><li class="listitem"><p>
            add your own rules
          </p></li></ul></div><p>
        Changes performed to the file context using the <code class="command">semanage
        fcontext</code> command do not require modifications or
        recompilation of the policy.
      </p><p>
        On top of the common options described in
        <a class="xref" href="index.html#list-common-options" title="Common options">Common options</a>, the <code class="command">semanage
        fcontext</code> command takes the following options:
      </p><div class="variablelist"><dl class="variablelist"><dt id="id-1.8.9.10.6.1"><span class="term"><code class="option">-e</code>, <code class="option">--equal</code></span></dt><dd><p>
              The option enables you to use the context of the provided path
              context to label files in a different directory (the provided
              target path). For example, you want to assign the same context as
              <code class="filename">/home</code> has to an alternative home directory
              <code class="filename">/export/home</code>. If you use this option, you
              need to provide the source path and the target path:
            </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code>semanage fcontext -a -e /home /export/home</pre></div></dd><dt id="id-1.8.9.10.6.2"><span class="term"><code class="option">-f</code>, <code class="option">--ftype</code></span></dt><dd><p>
              To specify a file type. Use one of the following values:
            </p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>
                  <code class="option">a</code> - all files, which is also the default
                  value
                </p></li><li class="listitem"><p>
                  <code class="option">b</code> - a block device
                </p></li><li class="listitem"><p>
                  <code class="option">c</code> - a character device
                </p></li><li class="listitem"><p>
                  <code class="option">d</code> - a directory
                </p></li><li class="listitem"><p>
                  <code class="option">f</code> - regular files
                </p></li><li class="listitem"><p>
                  <code class="option">l</code> - a symbolic link
                </p></li><li class="listitem"><p>
                  <code class="option">p</code> - a named pipe
                </p></li><li class="listitem"><p>
                  <code class="option">s</code> - a socket
                </p></li></ul></div></dd></dl></div></section><section class="sect3" id="semanage-login-command" data-id-title="The semanage login command"><div class="titlepage"><div><div><div class="title-container"><h4 class="title"><span class="title-number-name"><span class="title-number">7.5.2 </span><span class="title-name">The <code class="command">semanage login</code> command</span></span> <a title="Permalink" class="permalink" href="index.html#semanage-login-command">#</a></h4><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a></div></div></div></div></div><p>
        The <code class="command">semanage login</code> enables you the perform the
        following tasks:
      </p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>
            Mapping of Linux users on a particular SELinux user. For example,
            to map the Linux user <span class="emphasis"><em>tux</em></span> on
            <code class="literal">sysadm_u</code>, run the command:
          </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code><code class="command">semanage login -a -s sysadm_u tux</code></pre></div></li><li class="listitem"><p>
            Mapping of a group of Linux users on a particular SELinux user. For
            example, to map users of the <span class="emphasis"><em>writers</em></span> group on
            <code class="literal">user_u</code>, run the command:
          </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code><code class="command">semanage login -a -s user_u %writers</code></pre></div><p>
            The group is then listed in the output of <code class="command">semanage login
            -l</code>, prefixed with the % character.
          </p><p>
            Keep in mind that the user group should be primary because mapping
            SELinux users on supplementary groups may result in incompatible
            mappings.
          </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code><code class="command">semanage login -m -s staff_u %writers</code></pre></div></li><li class="listitem"><p>
            Mapping of Linux users on a particular SELinux MLS/MCS security
            range.
          </p></li><li class="listitem"><p>
            Modifying of the already created mapping. For this purpose, just
            replace the <code class="option">-a</code> option with <code class="option">-m</code> in
            the previous commands.
          </p></li><li class="listitem"><p>
            Setting the default SELinux user for new Linux users. The usual
            default SELinux user is <code class="literal">unconfined_u</code>. To change
            the value to <code class="literal">staff_u</code>, run the command:
          </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code><code class="command">semanage login -m -s staff_u __default__</code></pre></div></li></ul></div></section><section class="sect3" id="semanage-boolean-command" data-id-title="The semanage boolean command"><div class="titlepage"><div><div><div class="title-container"><h4 class="title"><span class="title-number-name"><span class="title-number">7.5.3 </span><span class="title-name">The <code class="command">semanage boolean</code> command</span></span> <a title="Permalink" class="permalink" href="index.html#semanage-boolean-command">#</a></h4><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a></div></div></div></div></div><p>
        The <code class="command">semanage boolean</code> command is used to control
        Booleans in the SELinux policy.
      </p><p>
        The command synopsis looks as follows:
      </p><div class="verbatim-wrap"><pre class="screen">semanage boolean [-h] [-n]  [ --extract |
       --deleteall | --list [-C] | --modify ( --on | --off | -1 | -0 ) boolean ]</pre></div><p>
        On top of the common options, you can use the following ones specific
        to the <code class="command">semanage boolean</code> command:
      </p><div class="variablelist"><dl class="variablelist"><dt id="id-1.8.9.12.6.1"><span class="term">--list -C</span></dt><dd><p>
              To display a list of local modifications to Booleans.
            </p></dd><dt id="id-1.8.9.12.6.2"><span class="term">-m --on | -1</span></dt><dd><p>
              To switch the provided Boolean on.
            </p></dd><dt id="id-1.8.9.12.6.3"><span class="term">-m --off | -0</span></dt><dd><p>
              To switch the provided Boolean off.
            </p></dd><dt id="id-1.8.9.12.6.4"><span class="term">-D, --deleteall</span></dt><dd><p>
              To delete all local modifications to Booleans.
            </p></dd></dl></div><p>
        The most common usage of the command is to switch on or off a
        particular Boolean. For example, to switch on the
        <code class="literal">authlogin_yubikey</code> Boolean, run:
      </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code><code class="command">semanage boolean -m on authlogin_yubikey</code></pre></div></section><section class="sect3" id="semanage-user-command" data-id-title="The semanage user command"><div class="titlepage"><div><div><div class="title-container"><h4 class="title"><span class="title-number-name"><span class="title-number">7.5.4 </span><span class="title-name">The <code class="command">semanage user</code> command</span></span> <a title="Permalink" class="permalink" href="index.html#semanage-user-command">#</a></h4><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a></div></div></div></div></div><p>
        The <code class="command">semanage user</code> command controls the mapping
        between the SELinux user and the roles and MLS/MCS levels.
      </p><p>
        On top of the common options described in
        <a class="xref" href="index.html#list-common-options" title="Common options">Common options</a>, the <code class="command">semanage
        use</code> command takes the following options:
      </p><div class="variablelist"><dl class="variablelist"><dt id="id-1.8.9.13.4.1"><span class="term">-R [ROLES], --roles [ROLES]</span></dt><dd><p>
              A list of SELinux roles. You can enclose multiple roles within
              double quotes and separate them by spaces, or you can use the
              <code class="option">-R</code> several times.
            </p></dd></dl></div><p>
        Using this command, you can perform the following tasks:
      </p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>
            Listing the mapping of SELinux users on roles by running:
          </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code><code class="command">semanage user -l</code></pre></div></li><li class="listitem"><p>
            Changing the roles assigned to the <code class="literal">user_u</code>
            SELinux user:
          </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code><code class="command">semanage user -m -R "system_r unconfined_r user_r"</code></pre></div></li><li class="listitem"><p>
            Assigning to <code class="literal">admin_u</code> the role
            <code class="literal">staff_r</code> and a category <code class="literal">s0</code>:
          </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code><code class="command">semanage user -a -R "staff_r -r s0 admin_u</code></pre></div></li><li class="listitem"><p>
            Creating a new SELinux user, for example,
            <code class="literal">admin_u</code> with the <code class="literal">staff_r</code>
            role. You also need to define the labeling prefix for this user by
            using the <code class="option">-P</code>:
          </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code><code class="command">semanage user -a -R "staff_r" -P admin admin_u</code></pre></div></li></ul></div></section><section class="sect3" id="semanage-module-command" data-id-title="The semanage module command"><div class="titlepage"><div><div><div class="title-container"><h4 class="title"><span class="title-number-name"><span class="title-number">7.5.5 </span><span class="title-name">The <code class="command">semanage module</code> command</span></span> <a title="Permalink" class="permalink" href="index.html#semanage-module-command">#</a></h4><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a></div></div></div></div></div><p>
        The <code class="command">semanage module</code> command can install, remove,
        disable or enable SELinux policy modules.
      </p><p>
        On top of the common options described in
        <a class="xref" href="index.html#list-common-options" title="Common options">Common options</a>, the <code class="command">semanage
        fcontext</code> command takes the following options:
      </p><div class="variablelist"><dl class="variablelist"><dt id="id-1.8.9.14.4.1"><span class="term"><code class="option">-d</code>, <code class="option">--disable</code></span></dt><dd><p>
              To disable the provided SELinux policy module:
            </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code><code class="command">semanage module --disable <em class="replaceable">MODULE_NAME</em></code></pre></div></dd><dt id="id-1.8.9.14.4.2"><span class="term"><code class="option">-e</code>, <code class="option">--enable</code></span></dt><dd><p>
              To enable the provided SELinux policy module:
            </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code><code class="command">semanage module --enable <em class="replaceable">MODULE_NAME</em></code></pre></div></dd></dl></div></section></section><section class="sect2" id="sestatus-command" data-id-title="The sestatus command"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">7.6 </span><span class="title-name">The <code class="command">sestatus</code> command</span></span> <a title="Permalink" class="permalink" href="index.html#sestatus-command">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a></div></div></div></div></div><p>
      The <code class="command">sestatus</code> gets the status of a system where SELinux
      is running.
    </p><p>
      The generic syntax of the command looks as follows:
    </p><div class="verbatim-wrap"><pre class="screen">sestatus <em class="replaceable">[OPTION]</em></pre></div><p>
      When run without any options and arguments, the command outputs the
      following information:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code><code class="command">sestatus</code>

SELinux status:                 enabled
SELinuxfs mount:                /sys/fs/selinux
SELinux root directory:         /etc/selinux
Loaded policy name:             targeted
Current mode:                   enforcing
Mode from config file:          enforcing
Policy MLS status:              enabled
Policy deny_unknown status:     allowed
Memory protection checking:     requested (insecure)
Max kernel policy version:      33</pre></div><p>
      The command can take the following options:
    </p><div class="variablelist"><dl class="variablelist"><dt id="id-1.8.10.8.1"><span class="term">-b</span></dt><dd><p>
            Displays the status of Booleans on the system.
          </p></dd><dt id="id-1.8.10.8.2"><span class="term">-v</span></dt><dd><p>
            Displays the security context of files and processes listed in the
            <code class="filename">/etc/sestatus.conf</code> file.
          </p></dd></dl></div></section></section><section class="sect1" id="legal-disclaimer" data-id-title="Legal Notice"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">8 </span><span class="title-name">Legal Notice</span></span> <a title="Permalink" class="permalink" href="index.html#legal-disclaimer">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a></div></div></div></div></div><p> Copyright© 2006–2024
 SUSE LLC and contributors.
  All rights reserved. </p><p>
    Permission is granted to copy, distribute and/or modify this document under the terms of the
    GNU Free Documentation License, Version 1.2 or (at your option) version 1.3; with the Invariant
    Section being this copyright notice and license. A copy of the license version 1.2 is included
    in the section entitled <span class="quote">“<span class="quote">GNU Free Documentation License</span>”</span>.
  </p><p>
    For SUSE trademarks, see <a class="link" href="https://www.suse.com/company/legal/" target="_blank">https://www.suse.com/company/legal/</a>. All other
    third-party trademarks are the property of their respective owners. Trademark symbols (®, ™
    etc.) denote trademarks of SUSE and its affiliates. Asterisks (*) denote third-party
    trademarks.
  </p><p>
    All information found in this book has been compiled with utmost attention to detail. However,
    this does not guarantee complete accuracy.  Neither SUSE LLC, its affiliates, the authors, nor
    the translators shall be held liable for possible errors or the consequences thereof.
  </p></section></section><nav class="bottom-pagination"><div> </div><div><a class="pagination-link next" href="doc-gfdl-license.html"><span class="pagination-relation">Next</span><span class="pagination-label"><span class="title-number">Appendix A </span>GNU Free Documentation License</span></a> </div></nav></article><aside id="_side-toc-page" class="side-toc"><div class="side-title">On this page</div><div class="toc"><ul><li><span class="section"><a href="index.html#selinux-about"><span class="title-number">1 </span><span class="title-name">About SELinux</span></a></span></li><li><span class="section"><a href="index.html#getting-selinux"><span class="title-number">2 </span><span class="title-name">Getting SELinux</span></a></span></li><li><span class="section"><a href="index.html#selinux-modes"><span class="title-number">3 </span><span class="title-name">SELinux modes</span></a></span></li><li><span class="section"><a href="index.html#selinux-context"><span class="title-number">4 </span><span class="title-name">SELinux security context</span></a></span></li><li><span class="section"><a href="index.html#selinux-policy"><span class="title-number">5 </span><span class="title-name">SELinux policy overview</span></a></span></li><li><span class="section"><a href="index.html#selinux-booleans"><span class="title-number">6 </span><span class="title-name">SELinux Booleans</span></a></span></li><li><span class="section"><a href="index.html#selinux-tools"><span class="title-number">7 </span><span class="title-name">Tools for managing SELinux</span></a></span></li><li><span class="section"><a href="index.html#legal-disclaimer"><span class="title-number">8 </span><span class="title-name">Legal Notice</span></a></span></li><li><span class="appendix"><a href="doc-gfdl-license.html"><span class="title-number">A </span><span class="title-name">GNU Free Documentation License</span></a></span></li></ul></div><div class="side-title">Share this page</div><ul class="share"><li><a id="_share-fb" href="#" title="Facebook"> </a></li><li><a id="_share-in" href="#" title="LinkedIn"> </a></li><li><a id="_share-tw" href="#" title="Twitter/X"> </a></li><li><a id="_share-mail" href="#" title="E-Mail"> </a></li><li><a id="_print-button" href="#" title="Print this page"> </a></li></ul> </aside></main><footer id="_footer"><div class="growth-inhibitor"><div class="copy"><span class="copy__rights">© SUSE
                 2024</span></div></div></footer></body></html>